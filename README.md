

```markdown
# Device Stats Collector

üìä –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ—ë –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –≤—Ä–µ–º–µ–Ω–∏.

## üîß –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3.10+
- FastAPI
- PostgreSQL
- SQLAlchemy (ORM)
- Pydantic
- Alembic (–º–∏–≥—Ä–∞—Ü–∏–∏)
- Docker / Docker Compose
- Locust (–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) 
```
## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/                # –†–æ—É—Ç—ã FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ core/               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ db/                 # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î, –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/             # ORM –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ repositories/       # –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ   ‚îú‚îÄ‚îÄ schemas/            # Pydantic-—Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ main.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ alembic/                # –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic
‚îú‚îÄ‚îÄ tests/                  # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ create_tables.py        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –±–µ–∑ Alembic
‚îî‚îÄ‚îÄ README.md


```
## üöÄ –ó–∞–ø—É—Å–∫

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/yourusername/device-stats-service.git
cd device-stats-service
```

2. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª`:

```env
DATABASE_URL=postgresql://postgres:postgres@db:5432/gazprom
```

3. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker-compose up --build
```

4. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
   ‚Üí http://localhost:8000/docs (Swagger UI)

## üß† API

### –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

```
POST /api/devices/{device_id}/data
```

**Body:**
```json
{
  "x": 1.1,
  "y": 2.2,
  "z": 3.3
}
```

### –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É

```
GET /api/devices/{device_id}/analytics
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `start_time` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `end_time` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "min": 0.0,
  "max": 9.8,
  "sum": 123.45,
  "count": 10,
  "median": 3.5
}
```

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

```
GET /api/users/{user_id}/analytics
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Locust

```bash
locust -f locustfile.py --host=http://localhost:8000
```

–û—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8089

## üê≥ Docker

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
docker-compose build          # –°–±–æ—Ä–∫–∞
docker-compose up             # –ó–∞–ø—É—Å–∫
docker-compose down           # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
docker-compose exec web alembic revision --autogenerate -m "init"
docker-compose exec web alembic upgrade head
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –±–µ–∑ Alembic

```bash
docker-compose exec web python create_tables.py
```



## üìé –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –í—Å–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∞–≤—Ç–æ—Ä—É.
```

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É —Å—Ä–∞–∑—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–∞–º `docker-compose.yml`, `Dockerfile`, `.env.example` –∏ `create_tables.py`, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç. –ì–æ—Ç–æ–≤?